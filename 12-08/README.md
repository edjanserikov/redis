# Домашнее задание к занятию "Резервное копирование баз данных" - `Джансериков Эдуард`

---

### Задание 1

```
Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования.

Необходимо описать, какие варианты резервного копирования подходят в случаях:

1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.
Ответ:
     Для восстановления данных в полном объёме за предыдущий день рекомендуется использовать инкрементное резервное копирование. 
     Инкрементное копирование позволяет создавать копии только измененных данных с момента предыдущего полного или инкрементного копирования. 
     Это уменьшает объём данных, которые нужно сохранять, и ускоряет процесс восстановления.


1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.
Ответ:
     Для восстановления данных за час до предполагаемой поломки рекомендуется использовать инкрементное резервное копирование в комбинации 
     с резервными копиями журналов транзакций (transaction log backups). 
     Это позволит минимизировать потери данных и восстановить базу данных почти до момента поломки.

1.3.* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую или починенную базу данных.
Ответ:
     Для обеспечения моментального переключения на работающую или починенную базу данных в случае поломки, рекомендуется использовать резервное копирование с помощью репликации. 
     В данном случае, лучший вариант — использование репликации базы данных.


Приведите ответ в свободной форме.
```

---

### Задание 2

```
2.1. С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore)

Ответ:
     Пример команды резервирования данных с помощью утилиты pg_dump:

     pg_dump -h localhost -U username -d dbname -f backup_file.sql

     где:
        localhost - хост базы данных
        username - имя пользователя базы данных
        dbname - имя базы данных, которую нужно забэкапить
        backup_file.sql - имя файла, в который будет сохранен бэкап данных

     Пример команды восстановления базы данных с помощью утилиты pg_restore:

     pg_restore -h localhost -U username -d dbname backup_file.sql

     где:
        localhost - хост базы данных
        username - имя пользователя базы данных
        dbname - имя базы данных, в которую нужно восстановить данные
        backup_file.sql - имя файла, из которого будет произведено восстановление данных

     Команды выполняются из командной строки, а не из оболочки PostgreSQL. 
     Также должны быть права на выполнение резервирования и восстановления базы данных.

2.1.* Возможно ли автоматизировать этот процесс? Если да, то как?
Ответ:
     Возможно. С помощью crnotab.
     Пример автоматизации резервирования базы данных с помощью cron на Linux:

     1. Создать shell скрипт для резервирования базы данных (backup.sh):
     #!/bin/bash
     pg_dump -h localhost -U username -d dbname -f /path/to/backup_file.sql

     2. Добавить права на выполнение скрипта:
     chmod +x backup.sh

     3. Открыть cron таблицу для редактирования:
     crontab -e

     4. Добавить строку в cron таблицу, чтобы запускать скрипт резервирования ежедневно, например, в 2 часа ночи:
     0 2 * * * /path/to/backup.sh


     Пример автоматизации восстановления базы данных с помощью cron на Linux:

     1. Создать shell скрипт для восстановления базы данных (restore.sh):
     #!/bin/bash
     pg_restore -h localhost -U username -d dbname /path/to/backup_file.sql

     2. Добавить права на выполнение скрипта:
     chmod +x restore.sh

     3. Открыть cron таблицу для редактирования:
     crontab -e

     4. Добавить строку в cron таблицу, чтобы запускать скрипт восстановления ежедневно, например, в 3 часа ночи:
     0 3 * * * /path/to/restore.sh

Приведите ответ в свободной форме.

```

---

### Задание 3

```
3.1. С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL.
Ответ:
     MySQL не поддерживает инкрементное резервное копирование "из коробки", как это делается в PostgreSQL с использованием pg_dump и резервных копий журналов транзакций.
     Однако, существует альтернативный подход к инкрементному резервному копированию базы данных MySQL с помощью комбинации утилиты mysqldump и бинарных журналов транзакций (binlog). 
     Вот как это можно сделать:

     Включить бинарное логирование (binary logging) в MySQL, чтобы сохранять журналы транзакций:
     Открыть файл my.cnf (обычно находится в /etc/mysql или /etc/my.cnf) и добавить следующую строку:
     log_bin = /path/to/binlog
     Где /path/to/binlog - путь к файлу, в котором будут сохраняться бинарные журналы транзакций.

     Перезапустить MySQL, чтобы применить изменения:
     sudo systemctl restart mysql

     Создать полное резервное копирование базы данных с помощью mysqldump:
     mysqldump -h localhost -u username -p dbname > full_backup.sql

     Регулярно создавать копии бинарных журналов транзакций для последующего использования в инкрементных копиях. 
     Для этого можно использовать команду mysqlbinlog:
     mysqlbinlog /path/to/binlog > binlog_backup.sql

     При необходимости создать инкрементное резервное копирование, которое содержит только измененные данные с момента последнего полного копирования. 
     Для этого можно объединить полное резервное копирование и файлы бинарных журналов транзакций:
     cat full_backup.sql binlog_backup.sql > incremental_backup.sql

     Теперь incremental_backup.sql содержит полное резервное копирование базы данных, а также все изменения, которые произошли после этого. 
     Это и будет вашим инкрементным резервным копированием.

     Стоит обратить внимание, что подход с использованием бинарных журналов транзакций может быть более сложным в управлении и требует аккуратности при восстановлении данных, 
     но он позволяет сделать инкрементные копии и минимизировать объем данных, которые нужно резервировать каждый раз.


3.1.* В каких случаях использование реплики будет давать преимущество по сравнению с обычным резервным копированием?
Ответ:
     Когда нужна высокая доступность - репликация обеспечивает возможность быстрого переключения на реплику в случае отказа основной базы данных (мастера). 
           Это позволяет минимизировать простой и обеспечивает непрерывную доступность данных.

     Когда нужно мгновенное восстановление - при сбое в работе основной базы данных, реплика может быть мгновенно активирована в качестве нового мастер-сервера, 
           что позволяет быстро восстановить работоспособность системы без необходимости ожидания восстановления данных из резервной копии.

     Когда нужна защита от ошибок пользователя - репликация может предотвратить потерю данных в результате ошибок пользователя, таких как случайное удаление или изменение данных. 
           Если такая ошибка произойдет на мастер-сервере, данные можно будет восстановить из реплики.

     Когда нужно распределение нагрузки - репликация позволяет распределить нагрузку между мастером и репликами, что улучшает производительность системы
           и позволяет обрабатывать больше запросов одновременно.

     Когда нужна тестирование и анализ - реплики могут использоваться для тестирования новых версий ПО или проведения анализа данных без воздействия на основную базу данных.

     Когда нужна географическое распределение - репликация позволяет создать реплики базы данных на удаленных серверах, что обеспечивает географическое распределение данных
           и повышает отказоустойчивость системы.

     Когда нужны частые точки восстановления - репликация позволяет создавать частые точки восстановления данных без необходимости полного резервного копирования каждый раз.

     В целом, репликация базы данных обеспечивает более высокую доступность, надежность и гибкость в сравнении с обычным резервным копированием. 
     Она является более удобным и эффективным способом обеспечения непрерывной работы системы и защиты данных.

Приведите ответ в свободной форме.
```

